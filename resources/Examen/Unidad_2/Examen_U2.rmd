---
title: "Análisis Estadístico Exploratorio"
author: "Josue Emmanuel Jauregui Arvilla"
date: "28 de Octubre de 2025"
output:
  html_document:
    toc: true          # Activa la tabla de contenido
    toc_depth: 3       # Niveles de encabezados que se mostrarán (##, ###, etc.)
    toc_float: true    # Hace que el índice flote en la parte lateral (HTML interactivo)
    number_sections: true  # Numera las secciones del documento
    theme: flatly          # (Opcional) Cambia el tema visual
---

# Introducción
El presente reporte analiza los datos de casos de dengue en México correspondientes al año 2020, enfocado en los estados de Michoacán, Colima, Nayarit, Jalisco y Guerrero.

El objetivo principal es describir el proceso completo, desde la preparación y depuración de los datos hasta el análisis de medidas de tendencia central (como la media) y de dispersión (como la desviación estándar), con el fin de comprender su utilidad en la base de datos de dengue.

Además, se incluyen diversos gráficos exploratorios como diagramas de caja, gráficos de densidad e histogramas que facilitan la interpretación visual y el entendimiento de los patrones presentes en los datos.

# Librerías necesarias
```{r}
# readxl es una libreria de R que nos permite leer el archivos con extension .xlsx, esto nos ayuda para poder
# realizar lecturas de sheets (tabs en excel)
library(readxl)

# lubridate es una libreria de R que nos permite trabajar con fechas, los cuales podemos extraer dia, mes y anio de alguna columna que contenga tipos de datos Date
library(lubridate)

# car es una libreria de R que nos permite generar graficos de densidad
library(car)
```

# Preparación de datos
En esta sección se describe el proceso de preparación de los datos de dengue en México, el cual incluye la carga del archivo principal y su integración con los catálogos complementarios de entidades federativas, municipios y sexo.

## Carga de Datos de Dengue
El archivo original de casos de dengue contiene 550,247 registros, correspondientes a los reportes del año 2020.

Dado que este archivo presenta los datos en su formato crudo, es necesario integrarlo con los catálogos de entidades federativas, municipios y sexo para enriquecer la información y facilitar su análisis y visualización posterior.

```{r}
# Carga de datos de dengue en México
dengue <- read.csv("/Users/jaureperro/PycharmProjects/Estadistica_Ciencia_de_Datos/data/dengue_abierto.csv")
length(dengue$ID_REGISTRO)
```

## Integración Catálogo Entidades Federativas
Para incorporar la información de las entidades federativas a la base de datos de dengue, se carga el catálogo oficial de entidades federativas utilizando la librería readxl, que permite la lectura de archivos con extensión .xlsx.

Una vez cargado el archivo, se realiza la integración entre la columna ENTIDAD_RES del conjunto de datos de dengue y la columna CLAVE_ENTIDAD del catálogo.

Este proceso permite asociar cada registro con el nombre de la entidad federativa correspondiente, enriqueciendo así la base de datos y facilitando su interpretación en los análisis posteriores.

```{r}
# Cargamos el archivo cat_dengue.xlsx y seleccionamos el sheet "CATÁLOGO ENTIDAD"
catalogo_entidad <- read_excel("/Users/jaureperro/PycharmProjects/Estadistica_Ciencia_de_Datos/data/cat_dengue.xlsx", sheet = "CATÁLOGO ENTIDAD")
catalogo_entidad
```

Al revisar la estructura del catálogo, se observa que la columna CLAVE_ENTIDAD tiene un tipo de dato character.

Para garantizar una correcta integración con la base de datos de dengue, es necesario convertir esta columna a tipo numérico mediante la función as.numeric(), la cual permite transformar valores de texto en valores numéricos compatibles para operaciones y uniones entre tablas.

```{r}
catalogo_entidad$CLAVE_ENTIDAD <- as.numeric(catalogo_entidad$CLAVE_ENTIDAD) # conversión a númerico
sapply(catalogo_entidad, class)
```

Se realiza la relación entre la columna CLAVE_ENTIDAD del catálogo de entidades federativas y la columna ENTIDAD_RES de la tabla de dengue.

Esta unión permite incorporar a la base de datos principal el nombre completo de la entidad federativa correspondiente a cada registro, mejorando así la legibilidad y el análisis posterior de la información.

```{r}
# Unión de la columna CLAVE_ENTIDAD con la columna ENTIDAD_RES de la tabla dengue
dengue2 <- merge(dengue,catalogo_entidad, by.x = "ENTIDAD_RES", by.y = "CLAVE_ENTIDAD")
dengue2[1,]
```

## Integracion Catálogo Sexo
Se realiza la unión entre la columna SEXO de la tabla de dengue y la columna CLAVE del catálogo, con el propósito de reemplazar los valores numéricos (1 o 2) por sus descripciones textuales (“HOMBRE” o “MUJER”), facilitando así la interpretación de los registros.

```{r}
catalogo_sexo <- read_excel("/Users/jaureperro/PycharmProjects/Estadistica_Ciencia_de_Datos/data/cat_dengue.xlsx", sheet = "CATÁLOGO SEXO")
sapply(catalogo_sexo, class)
```


En este caso, se observa que la columna CLAVE del catálogo de sexo es de tipo numérico, por lo que no es necesario realizar una conversión de tipo de dato.

A continuación, se procede a realizar la unión entre la columna CLAVE del catálogo y la columna SEXO de la tabla dengue2, la cual ya contiene la integración previa con el catálogo de entidades federativas.

Esta operación permite incorporar la descripción correspondiente al sexo dentro de la base de datos de dengue, facilitando su análisis y visualización.

```{r}
# Union de la columna CLAVE con la columna SEXO de la tabla dengue2
dengue3 <- merge(dengue2, catalogo_sexo, by.x = "SEXO", by.y = "CLAVE")
dengue3[1,]
```

## Integración Catálogo Municipio
Para integrar los municipios a nuestra tabla de dengue, es necesario cargar el archivo del catálogo de municipios.

Una vez cargado el archivo, se procede a realizar la integración de los datos de dengue a través de las columnas MUNICIPIO_RES (de la tabla de dengue) y las columnas CLAVE_MUNICIPIO y CLAVE_ENTIDAD (del catálogo de municipios).

Esta relación permite incorporar el nombre del municipio correspondiente a cada registro dentro de la base de datos de dengue, enriqueciendo la información geográfica disponible para su análisis posterior.

```{r}
catalogo_municipio <- read_excel("/Users/jaureperro/PycharmProjects/Estadistica_Ciencia_de_Datos/data/cat_dengue.xlsx", sheet = "CATÁLOGO MUNICIPIO")
sapply(catalogo_municipio, class)
```

Al momento de revisar los tipos de datos de las columnas del catálogo de municipios, se observa que tanto CLAVE_MUNICIPIO como CLAVE_ENTIDAD son de tipo character.

Por esta razón, es necesario convertirlas a tipo numérico utilizando la función as.numeric(), la cual permite realizar la conversión de datos de tipo character a numeric.
Sin embargo, al examinar la columna CLAVE_ENTIDAD, se identifican tres registros especiales con valores “USA”, “ALTN” y “OTROS”.

Si se aplicara la conversión directamente, estos valores serían transformados a NaN (Not a Number), generando mensajes de coerción en el proceso.
Para evitar este inconveniente, es necesario reemplazar previamente estos valores por los números correspondientes a las entidades federativas según el catálogo de entidades.

De esta forma, se garantiza la correcta conversión de los datos y la integración adecuada del catálogo de municipios con la tabla de dengue.

```{r}
# Se asignan los valores que corresponden de CATALOGO ENTIDAD para estas CLAVES de Entidad
catalogo_municipio[catalogo_municipio$CLAVE_ENTIDAD == "USA", 3] <- "33"
catalogo_municipio[catalogo_municipio$CLAVE_ENTIDAD == "ALTN", 3] <- "34"
catalogo_municipio[catalogo_municipio$CLAVE_ENTIDAD == "OTROS", 3] <- "35"

# Realiza la conversion numerica de CLAVE_ENTIDAD y CLAVE_MUNICIPIO a numerico
catalogo_municipio$CLAVE_ENTIDAD <- as.numeric(catalogo_municipio$CLAVE_ENTIDAD)
catalogo_municipio$CLAVE_MUNICIPIO <- as.numeric(catalogo_municipio$CLAVE_MUNICIPIO)
```

Una vez realizada la conversión de los tipos de datos de las columnas del catálogo de municipios, se procede a efectuar la unión de los datos.

En este paso, se relaciona la columna CLAVE_ENTIDAD y CLAVE_MUNICIPIO del catálogo de municipios con las columnas ENTIDAD_RES y MUNICIPIO_RES de la tabla dengue3.

Esta integración permite incorporar a la base principal el nombre del municipio correspondiente a cada registro de la tabla de dengue, facilitando así una mejor comprensión y análisis geográfico de los datos.

```{r}
dengue4 <- merge(x = dengue3, y = catalogo_municipio, by.x = c("ENTIDAD_RES","MUNICIPIO_RES"), by.y = c("CLAVE_ENTIDAD", "CLAVE_MUNICIPIO"), sort=FALSE)
dengue4[1,]
```

## Agregar columna de día, mes, año de registro
Para agregar las columnas correspondientes al día, mes y año de registro en la tabla de dengue, es necesario utilizar la librería lubridate, la cual facilita el manejo y la manipulación de datos de tipo fecha en R.

Esta librería permite extraer componentes individuales (como el día, el mes y el año) a partir de una fecha completa contenida en una columna.

```{r}

Sys.setlocale("LC_TIME", "es_ES.UTF-8")
# Realizamos la conversion de la columna FECHA_SIGN_SINTOMAS a el formato %d/%m/%y
dengue4$FECHA_SIGN_SINTOMAS <- as.Date(dengue4$FECHA_SIGN_SINTOMAS, tryFormats = "%d/%m/%y")

# Creamos una columna que se llama DIA_SIGN_SINTOMAS que contiene el dia del registro de la columna FECHA_SIGN_SINTOMAS
dengue4$DIA_SIGN_SINTOMAS <- day(dengue4$FECHA_SIGN_SINTOMAS)
# Creamos una columna que se llama MES_SIGN_SINTOMAS que contiene el mes del registro de la columna FECHA_SIGN_SINTOMAS
dengue4$MES_SIGN_SINTOMAS <- month(dengue4$FECHA_SIGN_SINTOMAS)
# Creamos la columna MES_SIGN_SINTOMAS_DESC que almacena los meses con caracteres y en mayúsculas
dengue4$MES_SIGN_SINTOMAS_DESC <- toupper(month(dengue4$FECHA_SIGN_SINTOMAS, label = TRUE, abbr = FALSE))
# Creamos una columna que se llama ANIO_SIGN_SINTOMAS que contiene el anio del registro de la columna FECHA_SIGN_SINTOMAS
dengue4$ANIO_SIGN_SINTOMAS <- year(dengue4$FECHA_SIGN_SINTOMAS)
dengue4[1,]

```

## Tabla de Dengue
Después de realizar la preparación de los datos, se observa que la base de datos de dengue conserva un total de 550,247 registros, al igual que en el inicio del proceso. No obstante, ahora incluye las columnas necesarias para identificar la entidad federativa, municipio, sexo, día, mes y año de registro lo que facilita la generación de gráficos descriptivos.

Con el fin de mantener una nomenclatura más clara y coherente, la tabla dengue4 fue renombrada como tabla_dengue.

```{r}
tabla_dengue <- dengue4
length(tabla_dengue$ID_REGISTRO)
```


## Obtención de los registros de las entidades federativas seleccionadas
Con el fin de realizar los análisis de este reporte, se extrajo una submuestra de los registros provenientes de las entidades federativas de Michoacán, Colima, Nayarit, Jalisco y Guerrero. Esta submuestra incluye 226,460 registros, lo que representa aproximadamente el 41% del total de 550,247 registros de la población estudiada.

Los datos se filtran de la siguiente manera:

```{r}
# Realizamos un filtro para obtener las entidades de "MICHOACÁN DE OCAMPO","COLIMA","NAYARIT","JALISCO","GUERRERO" de nuestra tabla dengue
estados_seleccionados <- tabla_dengue$ENTIDAD_FEDERATIVA %in% c("MICHOACÁN DE OCAMPO","COLIMA","NAYARIT","JALISCO","GUERRERO")

# Crearemos la variable info_estados_seleccionados contiene los registros de las entidades federativas anteriormente mencionadas
info_estados_seleccionados <- tabla_dengue[estados_seleccionados,]
paste("Cantidad de registros de las entidades filtradas: ", length(info_estados_seleccionados$ID_REGISTRO))
```

# Análisis de Tendencia Central y Dispersión
Una vez filtrados los datos, se procede al análisis de una medida de tendencia central y una medida de dispersión: la media y la desviación estándar de los pacientes reportados en las entidades federativas seleccionadas.

```{r}
# Creamos la funcion media_y_desviacion_estandar que como su nombre lo indica, obtiene la media y la desviación estándar
media_y_desviacion_estandar <- function (x){
  c(media = mean(x), desviacion_estandar = sd(x))
}

# Agrupamos la relación de la edad de los pacientes por la entidad federativa y el sexo mediante el uso de la función aggregate con los datos filtrados
media_edades_confirmados <- aggregate(EDAD_ANOS ~ ENTIDAD_FEDERATIVA + `DESCRIPCIÓN`, FUN=media_y_desviacion_estandar, data = info_estados_seleccionados)

# Ordenamos de manera ascendente los nombres de las entidades federativas
media_edades_confirmados <- media_edades_confirmados[order(media_edades_confirmados$ENTIDAD_FEDERATIVA),]

# Se fuerza la conversión del objeto media_edades_confirmados a un data frame
df_edades_confirmadas <- do.call(data.frame, media_edades_confirmados)

# Se renombran las columnas para tener nombres acordes al análisis
names(df_edades_confirmadas) <- c(
  "Entidad Federativa",
  "Sexo",
  "Media",
  "Desviación Estándar"
)
df_edades_confirmadas
```

De los datos presentados se observa que la edad promedio de los registros analizados se encuentra entre 22 y 34 años. Asimismo, se aprecia que en todas las entidades federativas consideradas, las mujeres presentan una media de edad superior a la de los hombres. Esto sugiere que, en promedio, las mujeres diagnosticadas tienden a ser ligeramente mayores que los hombres dentro de los mismos estados.

En cuanto a la desviación estándar, esta se sitúa entre 17 y 19 años, lo cual refleja una amplia dispersión en las edades. Dicho valor indica que la muestra incluye personas de diferentes edades, desde niños y adultos jóvenes hasta adultos mayores.

# Análisis gráfico de caja
Para reforzar la interpretación de los resultados anteriores, se elaboró un diagrama de cajas (boxplot) que muestra la distribución de edades por entidad federativa y sexo.

```{r boxplot_edad, fig.width=11, fig.height=7, dpi=300}
par(mar = c(5, 14, 4, 8), xpd = NA)
boxplot(EDAD_ANOS ~ `DESCRIPCIÓN` + ENTIDAD_FEDERATIVA,
        main = "Distribución de Edad por Entidad Federativa y Sexo",
        xlab = "Edad (años)",
        ylab = "",
        data = info_estados_seleccionados,
        horizontal = TRUE,
        las = 1,
        col = c("lightblue", "lightpink"),
        names = rep(c("H", "M"), 5),
        at = c(1, 2, 4, 5, 7, 8, 10, 11, 13, 14))

axis(2, at = c(1.5, 4.5, 7.5, 10.5, 13.5),
     labels = sort(unique(info_estados_seleccionados$ENTIDAD_FEDERATIVA)),
     las = 1, tick = FALSE, line = 1)
legend("topright",
       legend = c("Hombre", "Mujer"),
       fill = c("lightblue", "lightpink"),
       inset = c(-0.25, 0),   # mueve más hacia fuera
       xpd = NA,              # permite dibujar fuera de los márgenes del plot
       bty = "n")             # sin borde para verse más limpio
```

Podemos notar que en la mayoría de los casos, se observa que las mujeres presentan una mediana de edad superior a la de los hombres, lo cual coincide con el análisis previo y sugiere que, en promedio, las mujeres diagnosticadas tienden a ser ligeramente mayores que los hombres en los mismos estados.

El estado de Guerrero presenta un mayor número de valores atípicos (outliers), lo que indica la existencia de registros correspondientes a personas en edades más avanzadas, es decir, adultos mayores. Por otro lado, Jalisco muestra los promedios y medianas de edad más altos tanto en hombres como en mujeres, mientras que Guerrero concentra los promedios más bajos para ambos sexos, lo que sugiere que la población diagnosticada en esta entidad es, en general, más joven en comparación con las demás entidades federativas.

# Análisis gráfico de densidad
Otra manera de interpretar los datos es mediante un gráfico de densidad que muestra la distribución de edades por entidad federativa. Este gráfico nos permite conocer la forma de nuestra distribución.

```{r}

colores_estados <- c(
  "COLIMA" = "black",
  "GUERRERO" = "blue",
  "JALISCO" = "magenta",
  "MICHOACÁN DE OCAMPO" = "cyan",
  "NAYARIT" = "orange"
)


densityPlot(
  info_estados_seleccionados$EDAD_ANOS ~ as.factor(info_estados_seleccionados$ENTIDAD_FEDERATIVA),
  main = "Distribución de la Edad por Entidad Federativa",
  xlab = "", ylab = "", col = colores_estados,
  legend = list(title = "Entidad Federativa", cex = 0.8)
)
mtext("Edad (años)", side = 1, line = 2.5, cex = 1.1)
mtext("Densidad", side = 2, line = 2.5, cex = 1.1)
```

El gráfico de densidad permite observar que el dengue durante el año 2020 afectó principalmente a personas jóvenes, especialmente en el rango de 10 a 30 años.

Sin embargo, la presencia de colas largas hacia la derecha indica que también se registraron casos en edades más avanzadas.
Entre los estados analizados, Guerrero presenta la población más joven afectada, mientras que Jalisco y Colima muestran una distribución más amplia, lo que refleja una afectación más homogénea entre jóvenes y adultos.

En general, las distribuciones presentan una forma bimodal, con un primer pico pronunciado en edades jóvenes (entre 10 y 25 años) y un segundo pico menos marcado en edades adultas (aproximadamente entre 35 y 50 años).


# Distribución de edad en municipios con mayores registros de casos
Para determinar el municipio con mayor cantidad de casos de cada estado, se realiza primero un conteo de los registros de cada entidad federativa y municipio, seguido de un filtro para obtener los municipios con mayores registros, esto lo podemos hacer de la siguiente manera:

```{r}

# Se realiza un conteo de registros por entidad federativa y municipio
conteo_registros_municipio <- aggregate(info_estados_seleccionados$ID_REGISTRO ~ info_estados_seleccionados$ENTIDAD_FEDERATIVA + info_estados_seleccionados$MUNICIPIO , FUN = length)

# Se renombran la columnas para que contengan nombres mas cortos
colnames(conteo_registros_municipio) <- c("Estado", "Municipio", "Registros")

# Se obtiene la cantidad de registros más alto de cada estado
maximos_por_estado <- do.call(rbind, by(conteo_registros_municipio, conteo_registros_municipio$Estado, function(df) {
  df[which.max(df$Registros),]
}))
rownames(maximos_por_estado) <- NULL

# Se obtienen los registros de los estados y municipios con más registros
info_municipios_max <- info_estados_seleccionados[
  paste(info_estados_seleccionados$ENTIDAD_FEDERATIVA, info_estados_seleccionados$MUNICIPIO) %in%
  paste(maximos_por_estado$Estado, maximos_por_estado$Municipio),
]

# Se genera el gráfico de densidad en base a estos municipios y estados con más casos de registro
densityPlot(info_municipios_max$EDAD_ANOS ~ as.factor(info_municipios_max$MUNICIPIO),
            main = "Distribución de Edad en Municipios con Mayores Casos por Estado",
            xlab = "", ylab = "",
            legend = list(title = "Municipio"))

mtext("Edad (años)", side = 1, line = 2.5, cex = 1.1)
mtext("Densidad", side = 2, line = 2.5, cex = 1.1)
```

En general, las distribuciones presentan una forma bimodal, con un primer pico pronunciado en edades jóvenes (entre 10 y 25 años) y un segundo pico menos marcado en edades adultas (aproximadamente entre 35 y 50 años).

 Acapulco de Juárez presenta una mayor concentración en edades más jóvenes, mientras que Guadalajara y Morelia muestran un desplazamiento del segundo pico hacia edades adultas, lo que indica una población afectada de mayor edad promedio.

Por otro lado, Manzanillo y Tepic muestran una distribución más uniforme entre ambos grupos.

En todos los municipios seleccionados, la densidad disminuye gradualmente a partir de los 60 años, lo cual indica que las edades avanzadas tienen una menor representación entre los casos, es decir, hay pocos.

# Gráficos de barras de los registros entre el mes de Enero y Septiembre de los estados seleccionados

## Jalisco
```{r}
registros_estado <- info_estados_seleccionados[info_estados_seleccionados$ENTIDAD_FEDERATIVA == "JALISCO" & (info_estados_seleccionados$MES_SIGN_SINTOMAS >= 1 & info_estados_seleccionados$MES_SIGN_SINTOMAS <= 9),]
frecuencia_estado <- aggregate(ID_REGISTRO ~ MES_SIGN_SINTOMAS + MES_SIGN_SINTOMAS_DESC, FUN=length, data = registros_estado)
frecuencia_estado <- frecuencia_estado[order(frecuencia_estado$MES_SIGN_SINTOMAS), ]

par(mar = c(8, 6, 4, 2))
colores <- rainbow(length(frecuencia_estado$ID_REGISTRO))
barplot(
  frecuencia_estado$ID_REGISTRO,
  names.arg = frecuencia_estado$MES_SIGN_SINTOMAS_DESC,
  col = colores,
  xlab = "",
  ylab = "",
  cex.names = 0.9,    # Tamaño del texto de los nombres
  cex.axis = 0.9,     # Tamaño del texto de los ejes
  las = 2)

# Títulos de los ejes y gráfico (con separación ajustada)
mtext("Meses", side = 1, line = 5, cex = 1.1)      # Eje X (más abajo)
mtext("Registros", side = 2, line = 4, cex = 1.1)  # Eje Y (más a la izquierda)
title(main = "Distribución de nuevos casos por mes en el estado de Jalisco", line = 1)
```

## Colima

```{r}
registros_estado <- info_estados_seleccionados[info_estados_seleccionados$ENTIDAD_FEDERATIVA == "COLIMA" & (info_estados_seleccionados$MES_SIGN_SINTOMAS >= 1 & info_estados_seleccionados$MES_SIGN_SINTOMAS <= 9),]
frecuencia_estado <- aggregate(ID_REGISTRO ~ MES_SIGN_SINTOMAS + MES_SIGN_SINTOMAS_DESC, FUN=length, data = registros_estado)
frecuencia_estado <- frecuencia_estado[order(frecuencia_estado$MES_SIGN_SINTOMAS), ]

par(mar = c(8, 6, 4, 2))
colores <- rainbow(length(frecuencia_estado$ID_REGISTRO))
barplot(
  frecuencia_estado$ID_REGISTRO,
  names.arg = frecuencia_estado$MES_SIGN_SINTOMAS_DESC,
  col = colores,
  xlab = "",
  ylab = "",
  cex.names = 0.9,    # Tamaño del texto de los nombres
  cex.axis = 0.9,     # Tamaño del texto de los ejes
  las = 2)

# Títulos de los ejes y gráfico (con separación ajustada)
mtext("Meses", side = 1, line = 5, cex = 1.1)      # Eje X (más abajo)
mtext("Registros", side = 2, line = 4, cex = 1.1)  # Eje Y (más a la izquierda)
title(main = "Distribución de nuevos casos por mes en el estado de Colima", line = 1)
```

## Guerrero

```{r}
registros_estado <- info_estados_seleccionados[info_estados_seleccionados$ENTIDAD_FEDERATIVA == "GUERRERO" & (info_estados_seleccionados$MES_SIGN_SINTOMAS >= 1 & info_estados_seleccionados$MES_SIGN_SINTOMAS <= 9),]
frecuencia_estado <- aggregate(ID_REGISTRO ~ MES_SIGN_SINTOMAS + MES_SIGN_SINTOMAS_DESC, FUN=length, data = registros_estado)
frecuencia_estado <- frecuencia_estado[order(frecuencia_estado$MES_SIGN_SINTOMAS), ]

par(mar = c(8, 6, 4, 2))
colores <- rainbow(length(frecuencia_estado$ID_REGISTRO))
barplot(
  frecuencia_estado$ID_REGISTRO,
  names.arg = frecuencia_estado$MES_SIGN_SINTOMAS_DESC,
  col = colores,
  xlab = "",
  ylab = "",
  cex.names = 0.9,    # Tamaño del texto de los nombres
  cex.axis = 0.9,     # Tamaño del texto de los ejes
  las = 2)

# Títulos de los ejes y gráfico (con separación ajustada)
mtext("Meses", side = 1, line = 5, cex = 1.1)      # Eje X (más abajo)
mtext("Registros", side = 2, line = 4, cex = 1.1)  # Eje Y (más a la izquierda)
title(main = "Distribución de nuevos casos por mes en el estado de Guerrero", line = 1)
```

## Michoacán de Ocampo

```{r}
registros_estado <- info_estados_seleccionados[info_estados_seleccionados$ENTIDAD_FEDERATIVA == "MICHOACÁN DE OCAMPO" & (info_estados_seleccionados$MES_SIGN_SINTOMAS >= 1 & info_estados_seleccionados$MES_SIGN_SINTOMAS <= 9),]
frecuencia_estado <- aggregate(ID_REGISTRO ~ MES_SIGN_SINTOMAS + MES_SIGN_SINTOMAS_DESC, FUN=length, data = registros_estado)
frecuencia_estado <- frecuencia_estado[order(frecuencia_estado$MES_SIGN_SINTOMAS), ]

par(mar = c(8, 6, 4, 2))
colores <- rainbow(length(frecuencia_estado$ID_REGISTRO))
barplot(
  frecuencia_estado$ID_REGISTRO,
  names.arg = frecuencia_estado$MES_SIGN_SINTOMAS_DESC,
  col = colores,
  xlab = "",
  ylab = "",
  cex.names = 0.9,    # Tamaño del texto de los nombres
  cex.axis = 0.9,     # Tamaño del texto de los ejes
  las = 2)

# Títulos de los ejes y gráfico (con separación ajustada)
mtext("Meses", side = 1, line = 5, cex = 1.1)      # Eje X (más abajo)
mtext("Registros", side = 2, line = 4, cex = 1.1)  # Eje Y (más a la izquierda)
title(main = "Distribución de nuevos casos por mes en el estado de Michoácan", line = 1)
```

## Nayarit

```{r}
registros_estado <- info_estados_seleccionados[info_estados_seleccionados$ENTIDAD_FEDERATIVA == "NAYARIT" & (info_estados_seleccionados$MES_SIGN_SINTOMAS >= 1 & info_estados_seleccionados$MES_SIGN_SINTOMAS <= 9),]
frecuencia_estado <- aggregate(ID_REGISTRO ~ MES_SIGN_SINTOMAS + MES_SIGN_SINTOMAS_DESC, FUN=length, data = registros_estado)
frecuencia_estado <- frecuencia_estado[order(frecuencia_estado$MES_SIGN_SINTOMAS), ]

par(mar = c(8, 6, 4, 2))
colores <- rainbow(length(frecuencia_estado$ID_REGISTRO))
barplot(
  frecuencia_estado$ID_REGISTRO,
  names.arg = frecuencia_estado$MES_SIGN_SINTOMAS_DESC,
  col = colores,
  xlab = "",
  ylab = "",
  cex.names = 0.9,    # Tamaño del texto de los nombres
  cex.axis = 0.9,     # Tamaño del texto de los ejes
  las = 2)

# Títulos de los ejes y gráfico (con separación ajustada)
mtext("Meses", side = 1, line = 5, cex = 1.1)      # Eje X (más abajo)
mtext("Registros", side = 2, line = 4, cex = 1.1)  # Eje Y (más a la izquierda)
title(main = "Distribución de nuevos casos por mes en el estado de Nayarit", line = 1)
```
